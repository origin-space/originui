{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "comp-564",
  "type": "registry:component",
  "dependencies": [
    "@origin-space/image-cropper",
    "@radix-ui/react-slot",
    "class-variance-authority",
    "clsx",
    "react",
    "tailwind-merge"
  ],
  "files": [
    {
      "type": "registry:component",
      "target": "components/comp-564.tsx",
      "content": "\"use client\"\n\nimport { useCallback, useEffect, useState } from \"react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport {\n  Cropper,\n  CropperCropArea,\n  CropperDescription,\n  CropperImage,\n} from \"@/components/ui/cropper\"\n\n// Define type for pixel crop area\ntype Area = { x: number; y: number; width: number; height: number }\n\n// --- Start: Copied Helper Functions ---\nconst createImage = (url: string): Promise<HTMLImageElement> =>\n  new Promise((resolve, reject) => {\n    const image = new Image()\n    image.addEventListener(\"load\", () => resolve(image))\n    image.addEventListener(\"error\", (error) => reject(error))\n    image.setAttribute(\"crossOrigin\", \"anonymous\") // Needed for canvas Tainted check\n    image.src = url\n  })\n\nasync function getCroppedImg(\n  imageSrc: string,\n  pixelCrop: Area,\n  outputWidth: number = pixelCrop.width, // Optional: specify output size\n  outputHeight: number = pixelCrop.height\n): Promise<Blob | null> {\n  try {\n    const image = await createImage(imageSrc)\n    const canvas = document.createElement(\"canvas\")\n    const ctx = canvas.getContext(\"2d\")\n\n    if (!ctx) {\n      return null\n    }\n\n    // Set canvas size to desired output size\n    canvas.width = outputWidth\n    canvas.height = outputHeight\n\n    // Draw the cropped image onto the canvas\n    ctx.drawImage(\n      image,\n      pixelCrop.x,\n      pixelCrop.y,\n      pixelCrop.width,\n      pixelCrop.height,\n      0,\n      0,\n      outputWidth, // Draw onto the output size\n      outputHeight\n    )\n\n    // Convert canvas to blob\n    return new Promise((resolve) => {\n      canvas.toBlob((blob) => {\n        resolve(blob)\n      }, \"image/jpeg\") // Specify format and quality if needed\n    })\n  } catch (error) {\n    console.error(\"Error in getCroppedImg:\", error)\n    return null\n  }\n}\n// --- End: Copied Helper Functions ---\n\nconst ORIGINAL_IMAGE_URL =\n  \"https://res.cloudinary.com/dlzlfasou/image/upload/v1746526187/cropper-10_k24zxk.jpg\"\n\nexport default function Component() {\n  const [croppedAreaPixels, setCroppedAreaPixels] = useState<Area | null>(null)\n  const [croppedImageUrl, setCroppedImageUrl] = useState<string | null>(null)\n\n  // Callback to update crop area state\n  const handleCropChange = useCallback((pixels: Area | null) => {\n    setCroppedAreaPixels(pixels)\n  }, [])\n\n  // Function to handle the crop button click\n  const handleCrop = async () => {\n    if (!croppedAreaPixels) {\n      console.error(\"No crop area selected.\")\n      return\n    }\n\n    try {\n      const croppedBlob = await getCroppedImg(\n        ORIGINAL_IMAGE_URL,\n        croppedAreaPixels\n      )\n      if (!croppedBlob) {\n        throw new Error(\"Failed to generate cropped image blob.\")\n      }\n\n      // Create a new object URL\n      const newCroppedUrl = URL.createObjectURL(croppedBlob)\n\n      // Revoke the old URL if it exists\n      if (croppedImageUrl) {\n        URL.revokeObjectURL(croppedImageUrl)\n      }\n\n      // Set the new URL\n      setCroppedImageUrl(newCroppedUrl)\n    } catch (error) {\n      console.error(\"Error during cropping:\", error)\n      // Optionally: Clear the old image URL on error\n      if (croppedImageUrl) {\n        URL.revokeObjectURL(croppedImageUrl)\n      }\n      setCroppedImageUrl(null)\n    }\n  }\n\n  // Effect for cleaning up the object URL\n  useEffect(() => {\n    // This is the cleanup function that runs when the component unmounts\n    // or when croppedImageUrl changes before the next effect runs.\n    const currentUrl = croppedImageUrl\n    return () => {\n      if (currentUrl && currentUrl.startsWith(\"blob:\")) {\n        URL.revokeObjectURL(currentUrl)\n        console.log(\"Revoked URL:\", currentUrl) // Optional: for debugging\n      }\n    }\n  }, [croppedImageUrl]) // Dependency array ensures cleanup runs when URL changes\n\n  return (\n    <div className=\"flex flex-col items-center gap-2\">\n      <div className=\"flex w-full flex-col gap-4 md:flex-row\">\n        <Cropper\n          className=\"h-64 md:flex-1\"\n          image={ORIGINAL_IMAGE_URL}\n          onCropChange={handleCropChange}\n        >\n          <CropperDescription />\n          <CropperImage />\n          <CropperCropArea />\n        </Cropper>\n        <div className=\"flex w-26 flex-col gap-4\">\n          <Button onClick={handleCrop} disabled={!croppedAreaPixels}>\n            Crop preview\n          </Button>\n          {/* Display Area */}\n          <div className=\"aspect-square w-full shrink-0 overflow-hidden rounded-lg border\">\n            {croppedImageUrl ? (\n              <img\n                src={croppedImageUrl}\n                alt=\"Cropped result\"\n                className=\"h-full w-full object-cover\"\n              />\n            ) : (\n              <div className=\"bg-muted text-muted-foreground/80 flex h-full w-full items-center justify-center p-2 text-center text-xs\">\n                Image preview\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <p\n        aria-live=\"polite\"\n        role=\"region\"\n        className=\"text-muted-foreground mt-2 text-xs\"\n      >\n        Cropper with image preview âˆ™{\" \"}\n        <a\n          href=\"https://github.com/origin-space/image-cropper\"\n          className=\"hover:text-foreground underline\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          API\n        </a>\n      </p>\n    </div>\n  )\n}\n",
      "path": "registry/default/components/comp-564.tsx"
    },
    {
      "type": "registry:lib",
      "target": "lib/utils.ts",
      "content": "import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n",
      "path": "registry/default/lib/utils.ts"
    },
    {
      "type": "registry:ui",
      "target": "components/ui/button.tsx",
      "content": "import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground shadow-sm hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40\",\n        outline:\n          \"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2\",\n        sm: \"h-8 rounded-md px-3 text-xs\",\n        lg: \"h-10 rounded-md px-8\",\n        icon: \"size-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n",
      "path": "registry/default/ui/button.tsx"
    },
    {
      "type": "registry:ui",
      "target": "components/ui/cropper.tsx",
      "content": "\"use client\"\n\nimport { Cropper as CropperPrimitive } from \"@origin-space/image-cropper\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Cropper({\n  className,\n  ...props\n}: React.ComponentProps<typeof CropperPrimitive.Root>) {\n  return (\n    <CropperPrimitive.Root\n      data-slot=\"cropper\"\n      className={cn(\n        \"relative flex w-full cursor-move touch-none items-center justify-center overflow-hidden focus:outline-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CropperDescription({\n  className,\n  ...props\n}: React.ComponentProps<typeof CropperPrimitive.Description>) {\n  return (\n    <CropperPrimitive.Description\n      data-slot=\"cropper-description\"\n      className={cn(\"sr-only\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CropperImage({\n  className,\n  ...props\n}: React.ComponentProps<typeof CropperPrimitive.Image>) {\n  return (\n    <CropperPrimitive.Image\n      data-slot=\"cropper-image\"\n      className={cn(\n        \"pointer-events-none h-full w-full object-cover\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CropperCropArea({\n  className,\n  ...props\n}: React.ComponentProps<typeof CropperPrimitive.CropArea>) {\n  return (\n    <CropperPrimitive.CropArea\n      data-slot=\"cropper-crop-area\"\n      className={cn(\n        \"pointer-events-none absolute border-3 border-white shadow-[0_0_0_9999px_rgba(0,0,0,0.3)] in-[[data-slot=cropper]:focus-visible]:ring-[3px] in-[[data-slot=cropper]:focus-visible]:ring-white/50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Cropper, CropperDescription, CropperImage, CropperCropArea }\n",
      "path": "registry/default/ui/cropper.tsx"
    }
  ],
  "meta": {
    "tags": [
      "image",
      "crop",
      "zoom"
    ],
    "colSpan": 2
  }
}
